{"version":3,"file":"commonHelpers.js","sources":["../src/js/getImgs.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst APY_KEY = '19870120-8ec79e7454f8912b12bef551c';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst params = new URLSearchParams({\n  key: APY_KEY,\n  orientation: 'horizontal',\n  safesearch: true,\n  image_type: 'photo',\n  per_page: 40,\n});\n\nexport async function fetchImgs(search, page) {\n  const response = await axios.get(`?q=${search}&${params}&page=${page}`);\n\n  if (response.status !== 200) {\n    throw new Error('Some Error');\n  }\n\n  return response.data;\n}\n","import { fetchImgs } from './js/getImgs';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst error = {\n  title: 'Error',\n  message:\n    'Sorry, there are no images matching your search query. Please try again',\n  position: 'topRight',\n};\n\nconst info = {\n  title: 'Info',\n  message: 'We`re sorry, but you`ve reached the end of search results.',\n  position: 'topRight',\n};\n\nconst success = {\n  title: 'Success',\n  position: 'topRight',\n};\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  gallery: document.querySelector('.js-gallery'),\n  btnLoadMore: document.querySelector('.js-btn'),\n};\n\nrefs.form.addEventListener('submit', handlerSearchImg);\nrefs.btnLoadMore.addEventListener('click', handlerLoadMore);\n\nlet page = null;\nlet search = '';\nlet simpleLightBox;\n\nasync function handlerLoadMore() {\n  page += 1;\n  try {\n    const { hits, totalHits } = await fetchImgs(search, page);\n    createMarkup(hits);\n    getScroll();\n    simpleLightBox.refresh();\n    if (calcPage(totalHits)) return;\n  } catch (err) {\n    iziToast.error({ ...error, message: err.message });\n  }\n}\n\nasync function handlerSearchImg(e) {\n  hiddenBtn(true);\n  refs.gallery.innerHTML = '';\n  e.preventDefault();\n  search = e.currentTarget.elements.searchQuery.value;\n  page = 1;\n\n  if (!search.trim()) {\n    iziToast.error({\n      ...error,\n      message: 'Sorry, input is required to search for images',\n    });\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await fetchImgs(search, page);\n    if (hits.length === 0) {\n      iziToast.error(error);\n      return;\n    }\n    iziToast.success({\n      ...success,\n      message: `Hooray! We found ${totalHits} images.`,\n    });\n    createMarkup(hits);\n    simpleLightBox = new SimpleLightbox('.gallery a').refresh();\n\n    if (calcPage(totalHits)) return;\n    hiddenBtn(false);\n  } catch (err) {\n    iziToast.error({ ...error, message: err.message });\n  }\n}\n\nfunction createMarkup(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"item-photo\">\n        <div class=\"photo-card\">\n            <a href=\"${largeImageURL}\">\n              <img src=${webformatURL} alt=${tags} class=\"img\" data-big-img=${largeImageURL} />\n            </a>\n            <div class=\"stats\">\n                <p class=\"stats-item\">\n                  <b class=\"material-icons\">Likes</b>\n                  <span>${likes}</span>\n                </p>\n                <p class=\"stats-item\">\n                    <b class=\"material-icons\">Views</b>\n                    ${views}\n                </p>\n                <p class=\"stats-item\">\n                    <b class=\"material-icons\">Comments</b>\n                    ${comments}\n                </p>\n                <p class=\"stats-item\">\n                    <b class=\"material-icons\">Downloads</b>\n                    ${downloads}\n                </p>\n            </div>\n        </div>\n      </li>\n`\n    )\n    .join('');\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction hiddenBtn(bool) {\n  refs.btnLoadMore.hidden = bool;\n}\n\nfunction calcPage(totalHits) {\n  const allPages = Math.ceil(totalHits / 40);\n  if (page >= allPages) {\n    iziToast.info(info);\n    hiddenBtn(true);\n    return true;\n  }\n}\n\nfunction getScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 3,\n    behavior: 'smooth',\n  });\n}\n"],"names":["APY_KEY","axios","params","fetchImgs","search","page","response","error","info","success","refs","handlerSearchImg","handlerLoadMore","simpleLightBox","hits","totalHits","createMarkup","getScroll","calcPage","err","iziToast","hiddenBtn","SimpleLightbox","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","bool","allPages","cardHeight"],"mappings":"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"}